Add test case for W [O8pxmP] line 3.2
Refactor codebase with Z [sH2q88] line 9.1
